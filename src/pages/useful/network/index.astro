---
import BaseLayout from '../../../layouts/BaseLayout.astro';

const base = import.meta.env.BASE_URL.endsWith('/') ? import.meta.env.BASE_URL : `${import.meta.env.BASE_URL}/`;

const title = "Optimal Network Settings - Quake Live";
const description = "Diagnose and fix lag, jitter, packet loss, and inconsistent hit registration in Quake Live";
---

<BaseLayout title={title} description={description}>
  <div class="page-header">
    <nav class="breadcrumb">
      <a href={`${base}useful/`}>Useful</a> &gt; Network Settings
    </nav>
    <h1>Optimal Network & Connection Settings for Quake Live</h1>
    <p class="subtitle">Diagnose and fix lag, jitter, packet loss, and inconsistent hit registration</p>
    <p class="focus-note">Focused on real network behavior — not placebo tweaks.</p>
  </div>

  <!-- SECTION 1: Why Quake Live Is Different -->
  <section class="settings-section" id="why-different">
    <h2>Why Quake Live Is Different</h2>
    <p class="section-subtitle">Quake Live is unusually sensitive to timing consistency</p>

    <ul class="feature-list">
      <li><strong>Very small UDP packets</strong> — easily affected by buffering</li>
      <li><strong>High update frequency</strong> — needs consistent delivery</li>
      <li><strong>Tight hit verification windows</strong> — timing precision required</li>
      <li><strong>Client-side prediction with server reconciliation</strong> — jitter causes visible corrections</li>
    </ul>

    <p>As a result:</p>
    <ul class="consequence-list">
      <li><strong>Low jitter matters more than low latency</strong></li>
      <li><strong>Bufferbloat breaks gameplay</strong> while "ping looks fine"</li>
      <li><strong>1 Gbps bandwidth means nothing</strong> if packets arrive late or uneven</li>
      <li><strong>Game quality correlates more with stable upload than download or raw ping</strong></li>
    </ul>

    <div class="key-point">
      <strong>Key Point:</strong> A stable 30 ms connection feels better than an unstable 15 ms one.
    </div>
  </section>

  <!-- SECTION: Latency vs Jitter -->
  <section class="settings-section" id="latency-vs-jitter">
    <h2>Latency vs Jitter</h2>
    <p class="section-subtitle">Understanding the difference</p>

    <div class="definition-cards">
      <div class="definition-card">
        <h4>Latency (Ping)</h4>
        <p>The time it takes for a packet to travel from you to the server and back. Measured in milliseconds (ms).</p>
        <p class="example">Example: 25 ms ping means round-trip takes 25 ms.</p>
      </div>
      <div class="definition-card highlight">
        <h4>Jitter</h4>
        <p>Variation in latency from packet to packet. If your ping fluctuates between 20–40 ms, you have 20 ms of jitter.</p>
        <p class="example">In Quake Live, high jitter causes inconsistent snapshot timing and visible warping.</p>
      </div>
    </div>

    <table class="compare-table">
      <thead>
        <tr>
          <th>Scenario</th>
          <th>Ping</th>
          <th>Jitter</th>
          <th>Experience</th>
        </tr>
      </thead>
      <tbody>
        <tr class="good-row">
          <td>Stable fiber</td>
          <td>25 ms</td>
          <td>±1 ms</td>
          <td>Smooth, consistent</td>
        </tr>
        <tr class="ok-row">
          <td>Stable DSL</td>
          <td>40 ms</td>
          <td>±2 ms</td>
          <td>Fine, slightly slower</td>
        </tr>
        <tr class="bad-row">
          <td>Bufferbloat</td>
          <td>20 ms (avg)</td>
          <td>±50 ms</td>
          <td>Warping, inconsistent hits</td>
        </tr>
      </tbody>
    </table>

    <div class="info-box">
      <strong>Bottom line:</strong> A consistent 40 ms connection plays better than an inconsistent 20 ms one.
    </div>
  </section>

  <!-- SECTION: Quick Test Sequence -->
  <section class="settings-section quick-test" id="quick-test">
    <h2>Quick Test Sequence (5 minutes)</h2>
    <p class="section-subtitle">Test these first — in order</p>

    <ol class="test-sequence">
      <li>
        <span class="step-number">1</span>
        <div class="step-content">
          <strong>Test idle latency</strong>
          <span>Ping a game server with no other traffic</span>
        </div>
      </li>
      <li>
        <span class="step-number">2</span>
        <div class="step-content">
          <strong>Test under load (bufferbloat)</strong>
          <span>Run <a href="https://www.waveform.com/tools/bufferbloat" target="_blank" rel="noopener">Waveform bufferbloat test</a> — isolates bufferbloat vs clean ping</span>
        </div>
      </li>
      <li>
        <span class="step-number">3</span>
        <div class="step-content">
          <strong>Check packet loss & jitter</strong>
          <span>Use <a href="https://winmtr.net/download-winmtr" target="_blank" rel="noopener">WinMTR</a> — visualizes packet loss & latency on the entire route</span>
        </div>
      </li>
      <li>
        <span class="step-number">4</span>
        <div class="step-content">
          <strong>Test actual QL servers</strong>
          <span>Ping ranger, mynx, omega (see Step 5 below)</span>
        </div>
      </li>
    </ol>
  </section>

  <!-- SECTION 2: Common Symptoms -->
  <section class="settings-section" id="symptoms">
    <h2>Common Symptoms & Likely Causes</h2>
    <p class="section-subtitle">Quick diagnosis guide</p>

    <table class="symptoms-table">
      <thead>
        <tr>
          <th>Symptom</th>
          <th>Likely Cause</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><span class="symptom green">Green spikes in lagometer</span></td>
          <td>Jitter / bufferbloat</td>
        </tr>
        <tr>
          <td><span class="symptom red">Red spikes in lagometer</span></td>
          <td>Packet loss</td>
        </tr>
        <tr>
          <td>Shots feel delayed</td>
          <td>Upstream congestion</td>
        </tr>
        <tr>
          <td>Others say you warp (but you feel fine)</td>
          <td>Unstable upload</td>
        </tr>
        <tr>
          <td>Only one server feels bad</td>
          <td>ISP routing / peering</td>
        </tr>
        <tr>
          <td>Worse during uploads</td>
          <td>Bufferbloat</td>
        </tr>
        <tr>
          <td>Worse in evenings</td>
          <td>ISP congestion</td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- SECTION: Common Myths (moved up) -->
  <section class="settings-section" id="myths">
    <h2>Common Myths</h2>
    <p class="section-subtitle">Clear these up before diving deeper</p>

    <table class="myths-table">
      <thead>
        <tr>
          <th>Myth</th>
          <th>Reality</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Faster internet = better Quake</td>
          <td>Stability matters more than speed</td>
        </tr>
        <tr>
          <td>DNS lowers ping</td>
          <td>False — DNS only affects initial server lookup</td>
        </tr>
        <tr>
          <td>Port forwarding fixes lag</td>
          <td>False — QL uses outbound connections</td>
        </tr>
        <tr>
          <td>Disable Nagle's algorithm</td>
          <td>TCP only — QL uses UDP</td>
        </tr>
        <tr>
          <td>Everyone should use same settings</td>
          <td>Networks differ — test yours</td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- SECTION 3: Understanding the Lagometer -->
  <section class="settings-section" id="lagometer">
    <h2>Understanding the Lagometer</h2>
    <p class="section-subtitle">Your primary diagnostic tool for network issues</p>

    <p>The lagometer is a real-time graph showing how well your client is receiving data from the server. It's the single most useful tool for diagnosing connection problems in Quake Live.</p>

    <div class="code-block small">
      <pre><code>cg_lagometer 1</code></pre>
    </div>

    <div class="warning-box">
      <strong>Critical:</strong> The lagometer shows <strong>incoming server data only</strong>. If others say you warp but your lagometer looks clean, the problem is your <strong>upload</strong>, not download. The lagometer won't show this.
    </div>

    <h3>How to Read the Lagometer</h3>
    <p>The lagometer has two graphs stacked vertically:</p>

    <div class="lagometer-structure">
      <div class="graph-section">
        <h4>Upper Graph — Client Prediction</h4>
        <p>Shows how well your client is interpolating between server snapshots.</p>
        <table class="color-table">
          <tr>
            <td><span class="color-box blue"></span></td>
            <td><strong>Blue (below baseline)</strong></td>
            <td>Interpolating between valid snapshots. This is normal and good.</td>
          </tr>
          <tr>
            <td><span class="color-box yellow"></span></td>
            <td><strong>Yellow (above baseline)</strong></td>
            <td>Extrapolating — client is guessing because snapshots arrived late or not at all. Causes visible player warping.</td>
          </tr>
        </table>
      </div>

      <div class="graph-section">
        <h4>Lower Graph — Server Snapshots</h4>
        <p>Shows timing and delivery of snapshots from the server.</p>
        <table class="color-table">
          <tr>
            <td><span class="color-box green"></span></td>
            <td><strong>Green (steady height)</strong></td>
            <td>Normal snapshot delivery. Height = current ping.</td>
          </tr>
          <tr>
            <td><span class="color-box green"></span></td>
            <td><strong>Green (variable height)</strong></td>
            <td>Jitter — packets arriving at inconsistent intervals.</td>
          </tr>
          <tr>
            <td><span class="color-box yellow"></span></td>
            <td><strong>Yellow bars</strong></td>
            <td>Rate-limited — server suppressed this snapshot (rate cvar too low).</td>
          </tr>
          <tr>
            <td><span class="color-box red"></span></td>
            <td><strong>Red bars</strong></td>
            <td>Packet loss — snapshot never arrived.</td>
          </tr>
        </table>
      </div>
    </div>

    <h3>Visual Examples</h3>
    <p>Learn to recognize these patterns at a glance:</p>

    <div class="lagometer-infographic">
      <img src={`${base}images/lagometer-reference.png`} alt="Lagometer Quick Reference showing four states: Good/Stable (flat green bar, blue on top), Jitter/Bufferbloat (green spikes, jagged top), Packet Loss (red vertical bars, gaps), and Rate Limited (flat yellow bars on bottom)" loading="lazy" />
    </div>

    <h3>Test Your Own Connection</h3>
    <p>Reproduce issues to confirm bufferbloat:</p>
    <ol class="numbered-steps">
      <li>Join a server and enable <code>cg_lagometer 1</code></li>
      <li>Observe the lower graph — it should be steady green</li>
      <li>Start a speed test or cloud sync upload on your network</li>
      <li>Watch the lower graph: if green bars spike during upload, you have bufferbloat</li>
      <li>Enable SQM/QoS on your router to fix this</li>
    </ol>

    <div class="info-box">
      <strong>Key insight:</strong> If your lagometer spikes only during uploads or downloads, the problem is bufferbloat — not your ISP, not the server. This is fixable with proper router configuration.
    </div>
  </section>

  <!-- SECTION 4: Interpolation, Timenudge & Lag Compensation -->
  <section class="settings-section" id="timenudge">
    <h2>How Interpolation, Timenudge & Lag Compensation Work</h2>
    <p class="section-subtitle">Important: Understanding these mechanics</p>

    <div class="info-box">
      <p>Quake Live servers run at <strong>40 Hz</strong> (40 updates per second). The client buffers snapshots to smooth movement.</p>
    </div>

    <p><code>cl_timenudge</code> controls how far behind real time the client renders.</p>

    <h3>Key points:</h3>
    <ul class="feature-list">
      <li><strong>Lower (more negative) timenudge</strong> = less buffering</li>
      <li><strong>Less buffering</strong> = more responsive feel</li>
      <li><strong>But less buffering</strong> = less tolerance for jitter</li>
    </ul>

    <p>This is why:</p>
    <ul class="consequence-list">
      <li><code>cl_timenudge -20</code> can feel "snappier"</li>
      <li>But causes more visible warping on unstable connections</li>
    </ul>

    <h3>Lag Compensation (Backwards Reconciliation)</h3>
    <p>Quake Live uses <strong>server-side backward reconciliation</strong> for hitscan weapons:</p>
    <ul class="feature-list">
      <li>The server checks where the target <strong>was</strong> at the time of your shot</li>
      <li>Not where they are when the server receives it</li>
    </ul>

    <h4>Implications:</h4>
    <ul class="consequence-list">
      <li>Railgun hits register even at high ping (within limits)</li>
      <li>Dodging feels less intuitive vs high-ping players</li>
      <li>Being hit "behind corners" can happen legitimately</li>
    </ul>

    <div class="info-box">
      <strong>This is by design, not a bug.</strong>
    </div>
  </section>

  <!-- SECTION 5: Step 1 - Local Network -->
  <section class="settings-section" id="step1">
    <h2>Step 1: Eliminate Local Network Issues</h2>
    <p class="section-subtitle">Fix problems at the source</p>

    <h3>Use Ethernet (Mandatory)</h3>
    <ul class="feature-list">
      <li>Wi-Fi introduces jitter even with strong signal</li>
      <li>Powerline adapters are unreliable</li>
      <li><strong>Use a direct Ethernet cable to your router</strong></li>
    </ul>

    <h3>Eliminate Background Traffic</h3>
    <p>Disable or pause:</p>
    <ul class="disable-list">
      <li>Cloud sync (OneDrive, Google Drive, iCloud)</li>
      <li>Game launchers (Steam, Battle.net, Epic)</li>
      <li>Torrents / P2P</li>
      <li>Smart TVs / streaming devices</li>
      <li>OS updates</li>
    </ul>

    <h3>Network Adapter Settings (Windows)</h3>
    <p class="path-note">Device Manager → Network Adapter → Properties → Advanced</p>

    <table class="adapter-table">
      <thead>
        <tr>
          <th>Setting</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Energy Efficient Ethernet</td>
          <td>Disabled</td>
        </tr>
        <tr>
          <td>Interrupt Moderation</td>
          <td>Disabled</td>
        </tr>
        <tr>
          <td>Flow Control</td>
          <td>Disabled</td>
        </tr>
        <tr>
          <td>Green Ethernet</td>
          <td>Disabled</td>
        </tr>
        <tr>
          <td>Speed & Duplex</td>
          <td>1.0 Gbps Full Duplex</td>
        </tr>
      </tbody>
    </table>

    <p class="setting-note">Only change settings that exist on your adapter.</p>
  </section>

  <!-- SECTION 6: Step 2 - Router & ISP -->
  <section class="settings-section" id="step2">
    <h2>Step 2: Router & ISP Equipment</h2>
    <p class="section-subtitle">Reduce bufferbloat and congestion</p>

    <h3>Enable SQM / QoS (If Available)</h3>
    <p>Look for:</p>
    <ul class="feature-list compact">
      <li>SQM</li>
      <li>QoS</li>
      <li>Smart Queue</li>
      <li>fq_codel / CAKE</li>
      <li>"Gaming mode"</li>
    </ul>
    <p><strong>Set bandwidth to 85–90% of your real speed (up & down).</strong> This prevents bufferbloat.</p>

    <h3>Bufferbloat Explained</h3>
    <div class="ascii-diagram small">
      <pre>
UPLOAD FULL → router queues packets → game packets wait
           → packets arrive late
           → jitter spikes

Ping stays "low" but gameplay breaks.</pre>
    </div>

    <h3>Test Bufferbloat</h3>
    <p>Use: <a href="https://www.waveform.com/tools/bufferbloat" target="_blank" rel="noopener noreferrer">Waveform Bufferbloat Test</a> — isolates bufferbloat from clean latency. If your lagometer spikes during an upload or download test, it often indicates bufferbloat.</p>

    <table class="grade-table">
      <thead>
        <tr>
          <th>Grade</th>
          <th>Interpretation</th>
        </tr>
      </thead>
      <tbody>
        <tr class="grade-good">
          <td>A</td>
          <td>Excellent</td>
        </tr>
        <tr class="grade-ok">
          <td>B–C</td>
          <td>Acceptable</td>
        </tr>
        <tr class="grade-bad">
          <td>D–F</td>
          <td>Likely source of in-game issues</td>
        </tr>
      </tbody>
    </table>

    <h3>Disable Packet Inspection Features</h3>
    <p>If present, disable:</p>
    <ul class="disable-list">
      <li>DPI (Deep Packet Inspection)</li>
      <li>IDS / IPS</li>
      <li>"Advanced security"</li>
      <li>Parental filtering</li>
    </ul>
    <p class="setting-note">These cause latency spikes.</p>

    <h3>ISP-Specific Notes</h3>
    <div class="isp-cards">
      <div class="isp-card dsl">
        <h4>DSL (VDSL / ADSL)</h4>
        <ul>
          <li>Highly sensitive to bufferbloat</li>
          <li>SQM is critical</li>
          <li>Evening congestion common</li>
        </ul>
      </div>
      <div class="isp-card cable">
        <h4>Cable (DOCSIS)</h4>
        <ul>
          <li>Shared medium</li>
          <li>Upload congestion very common</li>
          <li>SQM strongly recommended</li>
        </ul>
      </div>
      <div class="isp-card fiber">
        <h4>Fiber (FTTH)</h4>
        <ul>
          <li>Lowest latency</li>
          <li>Still affected by poor routers</li>
          <li>ISP routing issues still possible</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- SECTION 7: Step 3 - DNS -->
  <section class="settings-section" id="step3">
    <h2>Step 3: DNS (Correct Expectations)</h2>
    <p class="section-subtitle">Keep it simple</p>

    <p>Use one resolver:</p>
    <div class="dns-options">
      <div class="dns-option">
        <code>1.1.1.1</code>
        <span>Cloudflare</span>
      </div>
      <div class="dns-option">
        <code>9.9.9.9</code>
        <span>Quad9</span>
      </div>
      <div class="dns-option">
        <code>8.8.8.8</code>
        <span>Google</span>
      </div>
    </div>

    <div class="warning-box">
      <strong>DNS does not lower ping.</strong><br>
      It only affects server discovery and initial connections.
    </div>
  </section>

  <!-- SECTION 8: Step 4 - Quake Live Settings -->
  <section class="settings-section" id="step4">
    <h2>Step 4: Quake Live Network Settings</h2>
    <p class="section-subtitle">In-game cvars that actually matter</p>

    <div class="code-block">
      <div class="code-header">
        <span>cfg</span>
        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      </div>
      <pre><code>rate 25000
com_idleSleep 0
cl_packetdup 0
cl_timenudge 0</code></pre>
    </div>

    <h3>When to Change cl_packetdup</h3>
    <p>Use <code>1–2</code> only if:</p>
    <ul class="feature-list">
      <li>You see red packet loss bars</li>
      <li>Others say you warp</li>
      <li>You cannot avoid Wi-Fi</li>
    </ul>
    <p class="setting-note">Trade-off: higher upload usage.</p>

    <h3>When to Change cl_timenudge</h3>
    <p>Use <code>-10</code> to <code>-20</code> only as last resort:</p>
    <ul class="feature-list">
      <li>Persistent yellow triangles</li>
      <li>Underlying network cannot be fixed</li>
    </ul>
    <p class="setting-note">Trade-off: adds artificial local delay to reduce warping.</p>

    <h3>Recommended Profiles</h3>
    <div class="profile-cards">
      <div class="profile-card stable">
        <h4>Stable connection</h4>
        <div class="code-block small">
          <pre><code>cl_packetdup 0
cl_timenudge 0</code></pre>
        </div>
      </div>
      <div class="profile-card unstable">
        <h4>Unstable</h4>
        <div class="code-block small">
          <pre><code>cl_packetdup 2
cl_timenudge 0</code></pre>
        </div>
      </div>
      <div class="profile-card lastresort">
        <h4>Last resort</h4>
        <div class="code-block small">
          <pre><code>cl_packetdup 2
cl_timenudge -15</code></pre>
        </div>
      </div>
    </div>
  </section>

  <!-- SECTION 9: Step 5 - Real Server Testing -->
  <section class="settings-section" id="step5">
    <h2>Step 5: Test Real Quake Live Servers</h2>
    <p class="section-subtitle">Test with actual game servers, not synthetic benchmarks</p>

    <h3>Common EU Test Servers</h3>
    <table class="server-table">
      <thead>
        <tr>
          <th>Server</th>
          <th>Address</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>ranger</td>
          <td><code>57.129.16.240</code></td>
        </tr>
        <tr>
          <td>mynx</td>
          <td><code>77.90.2.53:27980</code></td>
        </tr>
        <tr>
          <td>omega</td>
          <td><code>136.244.82.9</code></td>
        </tr>
      </tbody>
    </table>

    <h3>Ping Test</h3>
    <div class="code-columns">
      <div class="code-column">
        <h4>Windows</h4>
        <div class="code-block small">
          <pre><code>ping -n 50 57.129.16.240</code></pre>
        </div>
      </div>
      <div class="code-column">
        <h4>Linux / macOS</h4>
        <div class="code-block small">
          <pre><code>ping -c 50 57.129.16.240</code></pre>
        </div>
      </div>
    </div>

    <p>Look for:</p>
    <ul class="feature-list">
      <li>0% loss</li>
      <li>Tight min / avg / max</li>
      <li>No large spikes</li>
    </ul>

    <h3>Route Analysis (Advanced)</h3>
    <div class="tool-list">
      <div class="tool-item">
        <code>tracert</code> / <code>traceroute</code>
        <span>Basic route visualization — shows each hop to the server</span>
      </div>
      <div class="tool-item recommended">
        <a href="https://winmtr.net/download-winmtr" target="_blank" rel="noopener"><strong>WinMTR / mtr</strong></a>
        <span>Visualize packet loss & latency on the entire route — best for diagnosing where problems occur</span>
      </div>
      <div class="tool-item">
        <a href="https://packetlosstest.com" target="_blank" rel="noopener">Packet Loss Test</a>
        <span>Quick check for packet loss issues</span>
      </div>
    </div>
  </section>

  <!-- SECTION 10: Step 6 - Interpret Results -->
  <section class="settings-section" id="step6">
    <h2>Step 6: Interpret Results</h2>
    <p class="section-subtitle">What your tests mean</p>

    <table class="interpret-table">
      <thead>
        <tr>
          <th>Observation</th>
          <th>Meaning</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Stable ping, no loss</td>
          <td>Connection OK</td>
        </tr>
        <tr>
          <td>High max, low avg</td>
          <td>Jitter / bufferbloat</td>
        </tr>
        <tr>
          <td>Loss everywhere</td>
          <td>Local or ISP issue</td>
        </tr>
        <tr>
          <td>One server bad</td>
          <td>Routing / peering</td>
        </tr>
        <tr>
          <td>Evenings worse</td>
          <td>ISP congestion</td>
        </tr>
      </tbody>
    </table>

    <h3>VPNs & Tunnels</h3>
    <ul class="feature-list">
      <li>Can improve routing</li>
      <li>Can add latency</li>
      <li><strong>Prefer WireGuard-based tunnels</strong></li>
      <li>Avoid "privacy" VPNs for gaming</li>
    </ul>

    <div class="info-box">
      <strong>A stable VPN path is better than a faster but unstable direct route.</strong>
    </div>
  </section>

  <!-- SECTION 11: 5-Minute Checklist -->
  <section class="settings-section checklist-section" id="checklist">
    <h2>5-Minute Checklist (Quick Start)</h2>
    <p class="section-subtitle">Quick verification before playing</p>

    <ul class="final-checklist">
      <li><span class="check-icon">☐</span> Ethernet only</li>
      <li><span class="check-icon">☐</span> Stop uploads/downloads</li>
      <li><span class="check-icon">☐</span> Enable QoS / SQM if available</li>
      <li><span class="check-icon">☐</span> Disable DPI / IDS</li>
      <li><span class="check-icon">☐</span> <code>rate 25000</code> + <code>com_idleSleep 0</code></li>
      <li><span class="check-icon">☐</span> Test real QL servers</li>
      <li><span class="check-icon">☐</span> Watch lagometer</li>
      <li><span class="check-icon">☐</span> Adjust packetdup only if needed</li>
    </ul>
  </section>

  <!-- SECTION 13: Technical Reference -->
  <section class="settings-section" id="techref">
    <h2>Technical Reference</h2>
    <p class="section-subtitle">Quick facts</p>

    <table class="ref-table">
      <tbody>
        <tr>
          <td>Protocol</td>
          <td>UDP</td>
        </tr>
        <tr>
          <td>Server tickrate</td>
          <td>40 Hz</td>
        </tr>
        <tr>
          <td>Default port</td>
          <td>27960</td>
        </tr>
        <tr>
          <td>Hit verification</td>
          <td>Server-side reconciliation</td>
        </tr>
      </tbody>
    </table>

    <div class="final-note">
      <p>This guide prioritizes reproducible behavior over superstition.</p>
      <p><strong>Fix the network first — then tune the client.</strong></p>
    </div>
  </section>

  <div class="back-link">
    <a href={`${base}useful/`}>← Back to Useful Links</a>
  </div>
</BaseLayout>

<script is:inline>
function copyCode(btn) {
  const codeBlock = btn.closest('.code-block').querySelector('code');
  navigator.clipboard.writeText(codeBlock.textContent).then(() => {
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  });
}
</script>

<style>
  .breadcrumb {
    font-size: 0.875rem;
    color: var(--text-secondary, #888);
    margin-bottom: 0.5rem;
  }

  .breadcrumb a {
    color: var(--accent-primary, #ff6b35);
    text-decoration: none;
  }

  .breadcrumb a:hover {
    text-decoration: underline;
  }

  .subtitle {
    color: var(--text-secondary, #888);
    font-size: 1.1rem;
    margin-top: 0.5rem;
  }

  .focus-note {
    color: var(--accent-secondary, #4ecdc4);
    font-size: 0.9rem;
    font-style: italic;
    margin-top: 0.5rem;
  }

  /* Settings Sections */
  .settings-section {
    background: var(--bg-card, #1a1a24);
    border-radius: 8px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    border: 1px solid var(--border-color, #2a2a35);
  }

  .settings-section h2 {
    color: var(--accent-primary, #ff6b35);
    margin-bottom: 0.5rem;
    font-size: 1.4rem;
  }

  .settings-section h3 {
    color: var(--accent-secondary, #4ecdc4);
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    font-size: 1.1rem;
  }

  .settings-section h4 {
    color: var(--text-primary, #e8e8f0);
    margin-top: 1rem;
    margin-bottom: 0.5rem;
    font-size: 1rem;
  }

  .section-subtitle {
    color: var(--text-secondary, #888);
    margin-bottom: 1.5rem;
    font-size: 0.95rem;
  }

  /* Key Point Box */
  .key-point {
    background: rgba(78, 205, 196, 0.15);
    border: 1px solid var(--accent-secondary, #4ecdc4);
    border-radius: 6px;
    padding: 1rem;
    margin-top: 1.5rem;
    font-size: 0.95rem;
  }

  /* Definition Cards */
  .definition-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
  }

  .definition-card {
    background: var(--bg-secondary, #12121a);
    padding: 1.25rem;
    border-radius: 6px;
    border-left: 3px solid var(--text-secondary, #888);
  }

  .definition-card.highlight {
    border-color: var(--accent-primary, #ff6b35);
    background: rgba(255, 107, 53, 0.1);
  }

  .definition-card h4 {
    margin: 0 0 0.5rem 0;
    color: var(--text-primary, #e8e8f0);
  }

  .definition-card p {
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
    color: var(--text-secondary, #ccc);
  }

  .definition-card p.example {
    font-size: 0.85rem;
    color: var(--text-secondary, #888);
    font-style: italic;
    margin: 0;
  }

  /* Compare Table */
  .compare-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
  }

  .compare-table th,
  .compare-table td {
    padding: 0.6rem 0.75rem;
    border: 1px solid var(--border-color, #2a2a35);
    text-align: left;
    font-size: 0.9rem;
  }

  .compare-table th {
    background: var(--bg-secondary, #12121a);
    color: var(--accent-secondary, #4ecdc4);
    font-weight: 600;
  }

  .compare-table .good-row td:last-child { color: #2ecc71; }
  .compare-table .ok-row td:last-child { color: #f1c40f; }
  .compare-table .bad-row td:last-child { color: #e74c3c; }

  /* Quick Test Section */
  .quick-test {
    background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(78, 205, 196, 0.1));
    border-color: var(--accent-primary, #ff6b35);
  }

  .test-sequence {
    list-style: none;
    padding: 0;
    margin: 0;
    counter-reset: none;
  }

  .test-sequence li {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--border-color, #2a2a35);
  }

  .test-sequence li:last-child {
    border-bottom: none;
  }

  .step-number {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    background: var(--accent-primary, #ff6b35);
    color: white;
    border-radius: 50%;
    font-weight: 700;
    font-size: 0.9rem;
    flex-shrink: 0;
  }

  .step-content {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .step-content strong {
    color: var(--text-primary, #e8e8f0);
  }

  .step-content span {
    font-size: 0.85rem;
    color: var(--text-secondary, #888);
  }

  .step-content a {
    color: var(--accent-secondary, #4ecdc4);
  }

  /* Tool List */
  .tool-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin: 1rem 0;
  }

  .tool-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    padding: 0.75rem;
    background: var(--bg-secondary, #12121a);
    border-radius: 6px;
    border-left: 3px solid var(--border-color, #2a2a35);
  }

  .tool-item.recommended {
    border-color: var(--accent-secondary, #4ecdc4);
    background: rgba(78, 205, 196, 0.1);
  }

  .tool-item code {
    color: var(--accent-secondary, #4ecdc4);
  }

  .tool-item a {
    color: var(--accent-secondary, #4ecdc4);
    text-decoration: none;
  }

  .tool-item a:hover {
    text-decoration: underline;
  }

  .tool-item span {
    font-size: 0.85rem;
    color: var(--text-secondary, #888);
  }

  /* Lagometer Structure */
  .lagometer-structure {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin: 1.5rem 0;
  }

  .graph-section {
    background: var(--bg-secondary, #12121a);
    padding: 1.25rem;
    border-radius: 6px;
  }

  .graph-section h4 {
    color: var(--accent-secondary, #4ecdc4);
    margin: 0 0 0.5rem 0;
    font-size: 1rem;
  }

  .graph-section > p {
    font-size: 0.9rem;
    color: var(--text-secondary, #ccc);
    margin-bottom: 1rem;
  }

  .color-table {
    width: 100%;
    border-collapse: collapse;
  }

  .color-table tr td {
    padding: 0.5rem;
    border-bottom: 1px solid var(--border-color, #2a2a35);
    font-size: 0.9rem;
    vertical-align: top;
  }

  .color-table tr:last-child td {
    border-bottom: none;
  }

  .color-table td:first-child {
    width: 24px;
    padding-right: 0;
  }

  .color-table td:nth-child(2) {
    width: 180px;
    white-space: nowrap;
  }

  /* Lagometer Infographic */
  .lagometer-infographic {
    margin: 1.5rem 0;
    background: var(--bg-secondary, #12121a);
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
  }

  .lagometer-infographic img {
    max-width: 100%;
    height: auto;
    border-radius: 6px;
  }

  /* Numbered Steps */
  .numbered-steps {
    list-style: none;
    padding: 0;
    margin: 1rem 0;
    counter-reset: step-counter;
  }

  .numbered-steps li {
    counter-increment: step-counter;
    padding: 0.5rem 0 0.5rem 2.5rem;
    position: relative;
    font-size: 0.9rem;
    border-bottom: 1px solid var(--border-color, #2a2a35);
  }

  .numbered-steps li:last-child {
    border-bottom: none;
  }

  .numbered-steps li::before {
    content: counter(step-counter);
    position: absolute;
    left: 0;
    top: 0.5rem;
    width: 22px;
    height: 22px;
    background: var(--accent-secondary, #4ecdc4);
    color: var(--bg-primary, #0d0d14);
    border-radius: 50%;
    font-size: 0.8rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .numbered-steps li code {
    background: rgba(78, 205, 196, 0.2);
    padding: 0.1rem 0.3rem;
    border-radius: 3px;
    font-size: 0.85rem;
  }

  /* Feature & Consequence Lists */
  .feature-list,
  .consequence-list {
    list-style: none;
    padding: 0;
    margin: 1rem 0;
  }

  .feature-list li,
  .consequence-list li {
    padding: 0.4rem 0;
    padding-left: 1.5rem;
    position: relative;
  }

  .feature-list li::before {
    content: "→";
    position: absolute;
    left: 0;
    color: var(--accent-secondary, #4ecdc4);
  }

  .consequence-list li::before {
    content: "•";
    position: absolute;
    left: 0;
    color: var(--accent-primary, #ff6b35);
  }

  .feature-list.compact li {
    padding: 0.25rem 0 0.25rem 1.5rem;
  }

  /* Disable List */
  .disable-list {
    list-style: none;
    padding: 0;
    margin: 0.75rem 0;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 0.5rem;
  }

  .disable-list li {
    padding: 0.4rem 0.75rem;
    background: rgba(231, 76, 60, 0.1);
    border-radius: 4px;
    font-size: 0.9rem;
    color: var(--text-secondary, #ccc);
  }

  /* Symptoms Table */
  .symptoms-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
  }

  .symptoms-table th,
  .symptoms-table td {
    padding: 0.75rem;
    border: 1px solid var(--border-color, #2a2a35);
    text-align: left;
  }

  .symptoms-table th {
    background: var(--bg-secondary, #12121a);
    color: var(--accent-secondary, #4ecdc4);
    font-weight: 600;
  }

  .symptom {
    font-weight: 500;
  }

  .symptom.green {
    color: #2ecc71;
  }

  .symptom.red {
    color: #e74c3c;
  }

  /* ASCII Diagram */
  .ascii-diagram {
    background: var(--bg-secondary, #12121a);
    border-radius: 6px;
    padding: 1rem;
    margin: 1rem 0;
    overflow-x: auto;
  }

  .ascii-diagram pre {
    margin: 0;
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 0.85rem;
    line-height: 1.4;
    color: var(--text-primary, #e8e8f0);
    white-space: pre;
  }

  .ascii-diagram.small pre {
    font-size: 0.8rem;
  }

  /* Lagometer Tables */
  .lagometer-tables {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin: 1.5rem 0;
  }

  .lagometer-table {
    background: var(--bg-secondary, #12121a);
    padding: 1.25rem;
    border-radius: 6px;
  }

  .lagometer-table h4 {
    color: var(--accent-secondary, #4ecdc4);
    margin: 0 0 0.75rem 0;
  }

  .mini-table {
    width: 100%;
    border-collapse: collapse;
  }

  .mini-table tr td {
    padding: 0.5rem;
    border-bottom: 1px solid var(--border-color, #2a2a35);
    font-size: 0.9rem;
  }

  .mini-table tr:last-child td {
    border-bottom: none;
  }

  .mini-table td:first-child {
    white-space: nowrap;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .table-note {
    font-size: 0.85rem;
    color: var(--text-secondary, #888);
    margin-top: 0.75rem;
    font-style: italic;
  }

  .color-box {
    display: inline-block;
    width: 14px;
    height: 14px;
    border-radius: 2px;
    flex-shrink: 0;
  }

  .color-box.blue { background: #3498db; }
  .color-box.yellow { background: #f1c40f; }
  .color-box.green { background: #2ecc71; }
  .color-box.red { background: #e74c3c; }

  /* Adapter Table */
  .adapter-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
  }

  .adapter-table th,
  .adapter-table td {
    padding: 0.6rem 0.75rem;
    border: 1px solid var(--border-color, #2a2a35);
    text-align: left;
    font-size: 0.9rem;
  }

  .adapter-table th {
    background: var(--bg-secondary, #12121a);
    color: var(--accent-secondary, #4ecdc4);
    font-weight: 600;
  }

  .adapter-table td:last-child {
    color: #2ecc71;
    font-weight: 500;
  }

  .path-note {
    font-size: 0.85rem;
    color: var(--text-secondary, #888);
    font-family: monospace;
    margin-bottom: 0.75rem;
  }

  /* Grade Table */
  .grade-table {
    width: 100%;
    max-width: 400px;
    border-collapse: collapse;
    margin: 1rem 0;
  }

  .grade-table th,
  .grade-table td {
    padding: 0.6rem 0.75rem;
    border: 1px solid var(--border-color, #2a2a35);
    text-align: left;
    font-size: 0.9rem;
  }

  .grade-table th {
    background: var(--bg-secondary, #12121a);
    color: var(--accent-secondary, #4ecdc4);
    font-weight: 600;
  }

  .grade-table .grade-good td:first-child { color: #2ecc71; font-weight: 600; }
  .grade-table .grade-ok td:first-child { color: #f1c40f; font-weight: 600; }
  .grade-table .grade-bad td:first-child { color: #e74c3c; font-weight: 600; }

  /* ISP Cards */
  .isp-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
  }

  .isp-card {
    padding: 1rem;
    border-radius: 6px;
    border-left: 3px solid;
  }

  .isp-card.dsl {
    background: rgba(231, 76, 60, 0.1);
    border-color: #e74c3c;
  }

  .isp-card.cable {
    background: rgba(241, 196, 15, 0.1);
    border-color: #f1c40f;
  }

  .isp-card.fiber {
    background: rgba(46, 204, 113, 0.1);
    border-color: #2ecc71;
  }

  .isp-card h4 {
    margin: 0 0 0.5rem 0;
    font-size: 1rem;
  }

  .isp-card ul {
    list-style: disc;
    padding-left: 1.25rem;
    margin: 0;
    font-size: 0.85rem;
    color: var(--text-secondary, #ccc);
  }

  .isp-card li {
    padding: 0.2rem 0;
  }

  /* DNS Options */
  .dns-options {
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
    margin: 1rem 0;
  }

  .dns-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
  }

  .dns-option code {
    background: var(--bg-secondary, #12121a);
    padding: 0.5rem 1rem;
    border-radius: 4px;
    font-size: 1.1rem;
    color: var(--accent-secondary, #4ecdc4);
  }

  .dns-option span {
    font-size: 0.8rem;
    color: var(--text-secondary, #888);
  }

  /* Profile Cards */
  .profile-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
  }

  .profile-card {
    padding: 1rem;
    border-radius: 6px;
    border-left: 3px solid;
  }

  .profile-card.stable {
    background: rgba(46, 204, 113, 0.1);
    border-color: #2ecc71;
  }

  .profile-card.unstable {
    background: rgba(241, 196, 15, 0.1);
    border-color: #f1c40f;
  }

  .profile-card.lastresort {
    background: rgba(231, 76, 60, 0.1);
    border-color: #e74c3c;
  }

  .profile-card h4 {
    margin: 0 0 0.75rem 0;
    font-size: 0.95rem;
  }

  .profile-card .code-block {
    margin: 0;
  }

  /* Server Table */
  .server-table {
    width: 100%;
    max-width: 500px;
    border-collapse: collapse;
    margin: 1rem 0;
  }

  .server-table th,
  .server-table td {
    padding: 0.6rem 0.75rem;
    border: 1px solid var(--border-color, #2a2a35);
    text-align: left;
    font-size: 0.9rem;
  }

  .server-table th {
    background: var(--bg-secondary, #12121a);
    color: var(--accent-secondary, #4ecdc4);
    font-weight: 600;
  }

  .server-table code {
    color: var(--accent-secondary, #4ecdc4);
  }

  /* Code Columns */
  .code-columns {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
  }

  .code-column h4 {
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
    color: var(--text-secondary, #888);
  }

  /* Interpret & Myths Tables */
  .interpret-table,
  .myths-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
  }

  .interpret-table th,
  .interpret-table td,
  .myths-table th,
  .myths-table td {
    padding: 0.6rem 0.75rem;
    border: 1px solid var(--border-color, #2a2a35);
    text-align: left;
    font-size: 0.9rem;
  }

  .interpret-table th,
  .myths-table th {
    background: var(--bg-secondary, #12121a);
    color: var(--accent-secondary, #4ecdc4);
    font-weight: 600;
  }

  .myths-table td:first-child {
    color: var(--text-secondary, #aaa);
    text-decoration: line-through;
  }

  .myths-table td:last-child {
    color: #2ecc71;
  }

  /* Reference Table */
  .ref-table {
    width: 100%;
    max-width: 400px;
    border-collapse: collapse;
    margin: 1rem 0;
  }

  .ref-table td {
    padding: 0.6rem 0.75rem;
    border: 1px solid var(--border-color, #2a2a35);
    font-size: 0.9rem;
  }

  .ref-table td:first-child {
    color: var(--text-secondary, #888);
    width: 150px;
  }

  .ref-table td:last-child {
    color: var(--accent-secondary, #4ecdc4);
    font-weight: 500;
  }

  /* Final Note */
  .final-note {
    margin-top: 1.5rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color, #2a2a35);
    text-align: center;
    color: var(--text-secondary, #888);
    font-size: 0.95rem;
  }

  .final-note p {
    margin: 0.25rem 0;
  }

  .final-note strong {
    color: var(--accent-primary, #ff6b35);
  }

  /* Final Checklist */
  .checklist-section {
    background: linear-gradient(135deg, rgba(78, 205, 196, 0.1), rgba(255, 107, 53, 0.1));
    border-color: var(--accent-secondary, #4ecdc4);
  }

  .final-checklist {
    list-style: none;
    padding: 0;
    margin: 0;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 0.75rem;
  }

  .final-checklist li {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.5rem 0.75rem;
    background: var(--bg-secondary, #12121a);
    border-radius: 4px;
    font-size: 0.9rem;
  }

  .final-checklist code {
    background: rgba(78, 205, 196, 0.2);
    padding: 0.1rem 0.3rem;
    border-radius: 3px;
    font-size: 0.85rem;
  }

  .check-icon {
    font-size: 1.1rem;
    color: var(--accent-secondary, #4ecdc4);
  }

  /* Warning & Info Boxes */
  .warning-box {
    background: rgba(231, 76, 60, 0.15);
    border: 1px solid #e74c3c;
    border-radius: 6px;
    padding: 1rem;
    margin: 1rem 0;
    font-size: 0.9rem;
  }

  .info-box {
    background: rgba(52, 152, 219, 0.15);
    border: 1px solid #3498db;
    border-radius: 6px;
    padding: 1rem;
    margin: 1rem 0;
    font-size: 0.9rem;
  }

  .info-box p {
    margin: 0;
  }

  /* Code Block */
  .code-block {
    background: var(--bg-secondary, #12121a);
    border-radius: 6px;
    overflow: hidden;
    margin: 1rem 0;
  }

  .code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 1rem;
    background: rgba(255, 255, 255, 0.05);
    border-bottom: 1px solid var(--border-color, #2a2a35);
    font-size: 0.8rem;
    color: var(--text-secondary, #888);
  }

  .copy-btn {
    background: var(--accent-primary, #ff6b35);
    color: white;
    border: none;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.8rem;
    transition: background 0.2s;
  }

  .copy-btn:hover {
    background: #ff8c5a;
  }

  .code-block pre {
    margin: 0;
    padding: 1rem;
    overflow-x: auto;
  }

  .code-block code {
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 0.9rem;
    line-height: 1.6;
    color: var(--text-primary, #e8e8f0);
  }

  .code-block.small pre {
    padding: 0.75rem;
  }

  .code-block.small code {
    font-size: 0.85rem;
  }

  .setting-note {
    color: var(--text-secondary, #888);
    font-size: 0.9rem;
    margin-top: 0.5rem;
  }

  /* Back Link */
  .back-link {
    margin-top: 2rem;
  }

  .back-link a {
    color: var(--accent-primary, #ff6b35);
    text-decoration: none;
  }

  .back-link a:hover {
    text-decoration: underline;
  }

  /* Mobile Responsiveness */
  @media (max-width: 768px) {
    .definition-cards {
      grid-template-columns: 1fr;
    }

    .lagometer-tables {
      grid-template-columns: 1fr;
    }

    .isp-cards {
      grid-template-columns: 1fr;
    }

    .profile-cards {
      grid-template-columns: 1fr;
    }

    .code-columns {
      grid-template-columns: 1fr;
    }

    .final-checklist {
      grid-template-columns: 1fr;
    }

    .disable-list {
      grid-template-columns: 1fr;
    }

    .compare-table {
      font-size: 0.8rem;
    }

    .compare-table th,
    .compare-table td {
      padding: 0.4rem 0.5rem;
    }

    .color-table td:nth-child(2) {
      width: auto;
      white-space: normal;
    }
  }
</style>
